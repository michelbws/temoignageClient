<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Je suis témoin</title>
    <meta charset="UTF-8">
    <script src="Js/Upload.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"
            integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
            crossorigin="anonymous"></script>

    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id="form" align="center">
    <br>
  <img src="pizza.png" alt="Logo de Radio-Canada" style="width:100px;height:100px;border:0;">
<h1>Je suis témoin</h1>

        <h2>Envoyez-nous une photo, une vidéo ou un fichier audio</h2>
        <label for="fileUpload" />
        <input type="file" id="fileUpload" name="image" accept="image/*" capture style="display:none" onchange="UploadImage()" />
        <img src="photo.png" id="fileUpload" alt="Soumettre une photo" height="60" style="cursor:pointer" />&nbsp&nbsp&nbsp
        <input type="file" id="fileUpload" name="video" accept="video/*" capture style="display:none" />
        <img src="video.png" id="fileUpload" alt="Soumettre une vidéo" height="60" style="cursor:pointer" />&nbsp&nbsp&nbsp
        <input type="file" id="fileUpload" name="audio" accept="audio/*" capture style="display:none" />
        <img src="audio.png" id="fileUpload" alt="Soumettre un fichier audio" height="60" style="cursor:pointer" />
        <br>
        <br />
        <img src="" id="imageUpload" width="100" style="display:none" />
        <h2>Racontez-nous ce qui se passe</h2>
        <strong>Qui? Quoi? Où? Quand? Comment? Pourquoi?</strong><br>

        <textarea name="subject" id="subject" cols="50" rows="5"></textarea>
        <br />
                     <input id="btnUploadFile" alt="Envoyer le fichier" type="button" value="Finaliser le témoignage" style="color:#FFFFFF;background:#dd0000" onclick="SendForm()"><br>
        </div>
</body>
</html>



<script>
    

    function SendForm()
    {
        if (ValidForm())
        {
            var imagePath = jQuery("#imageUpload")[0].src;
            var description = jQuery("#subject")[0].value;

            SetCookie("TemoignageImagePath", imagePath);
            SetCookie("TemoignageDescription", description);

            window.location = "coordos.html";
        }        
    }

    function ValidForm()
    {
        return true;
    }

    function UploadImage()
    {
        var data = new FormData();

        var files = jQuery("#fileUpload").get(0).files;

        if (files.length > 0) {
            data.append("avatar", files[0]);
        }

        var ajaxRequest = jQuery.ajax({
            type: "POST",
            url: "https://dev-rli-services.radio-canada.ca/id/v3/avatar/upload-avatar?rcid=46CA97E7-44CA-4176-843D-2CD1B640DB41",
            contentType: false,
            processData: false,
            data: data,
            success: function (data) {
                jQuery("#imageUpload")[0].src = data;
                //jQuery("#imageUpload")[0].show();
                document.getElementById('imageUpload').style = "display:block";
            },
            error: function (data) {
                    //gérer les cas d'erreurs
            }
        });

        ajaxRequest.done(function (xhr, textStatus) {
            // Do other operation
        });


    }

    function SetCookie(name, value) {
        path = '/';
        domain = ''
        secondes = 24 * 60 * 60 * 1000 * 14; //2 semaines
        var today = new Date();
        today.setTime(today.getTime());
        var expires = new Date(today.getTime() + (secondes));
        var secure = "";


        document.cookie = name + "=" + value +
        ((expires) ? ";expires=" + expires.toGMTString() : "") +
        ((path) ? ";path=" + path : "") +
        ((domain) ? ";domain=" + domain : "") +
        ((secure) ? ";secure" : "");
    };

</script>  
